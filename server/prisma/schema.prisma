// This file is automatically generated by Prisma
// EduSphere Database Schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --------------------------------------
// ENUMS
// --------------------------------------

// SQLite doesn't support native enums, so we handle them as Strings in Prisma 
// but enforced in application logic.
// Status: PENDING, APPROVED, REJECTED, CORRECTION_REQUIRED
// DocType: AICTE, AFFILIATION, NAAC, PLACEMENT_PROOF

// --------------------------------------
// MODELS
// --------------------------------------

model Student {
  id             String   @id @default(uuid())
  phone          String   @unique
  otp_hash       String?  
  otp_expires_at DateTime?
  created_at     DateTime @default(now())

  profile        StudentProfile?
}

model StudentProfile {
  id              String  @id @default(uuid())
  student_id      String  @unique
  student         Student @relation(fields: [student_id], references: [id])
  
  full_name       String
  email           String  @unique
  country         String
  state           String
  district        String
  education_level String
}

model GovernmentUser {
  id            String  @id @default(uuid())
  employee_id   String  @unique
  password_hash String
  name          String

  verified_colleges College[]
  verification_logs VerificationLog[]
}

model College {
  id              String  @id @default(uuid())
  email           String  @unique
  password_hash   String
  code            String  @unique
  
  name            String
  address         String
  college_type    String   @default("Private") // Government / Private
  country         String   @default("India")
  state           String   @default("Unknown")
  district        String   @default("Unknown")
  website         String?
  principal_name  String
  principal_phone String

  // Status Enum: PENDING, APPROVED, REJECTED, CORRECTION_REQUIRED
  status          String  @default("PENDING")
  is_locked       Boolean @default(false)

  verified_by     String?
  verified_at     DateTime?
  verifier        GovernmentUser? @relation(fields: [verified_by], references: [id])
  remarks         String?

  // Relations
  academic_details  AcademicDetail?
  placement_details PlacementDetail?
  faculty           Faculty[]
  documents         Document[]
  verification_logs VerificationLog[]
}

model AcademicDetail {
  id              String  @id @default(uuid())
  college_id      String  @unique
  college         College @relation(fields: [college_id], references: [id], onDelete: Cascade)

  courses_offered String // JSON string
  fees_per_course String // JSON string
  intake_capacity Int
  accreditation   String?
}

model Faculty {
  id               String  @id @default(uuid())
  college_id       String
  college          College @relation(fields: [college_id], references: [id], onDelete: Cascade)

  name             String
  designation      String
  qualification    String
  experience_years Int
  department       String
}

model PlacementDetail {
  id                 String  @id @default(uuid())
  college_id         String  @unique
  college            College @relation(fields: [college_id], references: [id], onDelete: Cascade)

  placement_percentage Float
  avg_package          Float
  max_package          Float
  companies_visited    String // JSON string
  proof_url            String
}

model Document {
  id         String  @id @default(uuid())
  college_id String
  college    College @relation(fields: [college_id], references: [id], onDelete: Cascade)

  // Enum: AICTE, AFFILIATION, NAAC, PLACEMENT_PROOF
  doc_type   String
  file_url   String
}

model VerificationLog {
  id         String   @id @default(uuid())
  college_id String
  college    College  @relation(fields: [college_id], references: [id])

  officer_id String
  officer    GovernmentUser @relation(fields: [officer_id], references: [id])

  action     String // APPROVED, REJECTED, CORRECTION
  remarks    String
  timestamp  DateTime @default(now())
}

model Scholarship {
  id          String @id @default(uuid())
  name        String
  amount      String
  eligibility String
  link        String?
}

model TrendingCourse {
  id          String   @id @default(uuid())
  name        String
  category    String
  description String?
}
